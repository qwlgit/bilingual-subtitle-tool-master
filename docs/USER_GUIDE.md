# 📖 用户使用指南

## 🚀 快速开始

### 系统要求

- **操作系统**: Windows 10+ / macOS 10.14+ / Linux Ubuntu 18.04+
- **Python版本**: Python 3.7 或更高版本
- **内存**: 建议 4GB 以上
- **硬盘空间**: 500MB 可用空间

### 安装步骤

1. **克隆项目**
   ```bash
   git clone <repository-url>
   cd bilingual-subtitle-tool
   ```

2. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

3. **运行应用**
   ```bash
   # 使用重构后的新版本（推荐）
   python src/main.py
   
   # 或使用原版本
   python main.py
   ```

## 🎯 主要功能

### 1. 语音识别

**支持的音频源:**
- 🎤 麦克风输入
- 🔊 系统音频（音响输出）
- 🎧 USB耳机/音频设备
- 💻 虚拟音频设备

**识别特性:**
- 实时语音识别
- 双通道处理（在线/离线）
- 热词支持
- 多种采样率支持

### 2. 智能翻译

**翻译模式:**
- 🚀 **增量翻译**: 实时翻译片段文本
- 🎯 **完整翻译**: 高质量完整句子翻译
- 💾 **缓存机制**: 避免重复翻译
- ⚡ **双通道架构**: 平衡实时性和质量

**支持语言:**
- 中文 → 英文
- 可扩展其他语言对

### 3. 字幕显示

**主窗口显示:**
- 中文识别结果
- 英文翻译结果
- 实时状态更新
- 设备管理界面

**悬浮字幕窗口:**
- 透明背景设计
- 科技感视觉效果
- 可拖拽定位
- 自适应窗口大小
- 自定义透明度和字体

## 🎮 操作指南

### 启动应用

1. **运行程序**
   ```bash
   python src/main.py --help  # 查看所有可用参数
   ```

2. **常用启动参数**
   ```bash
   # 指定服务器地址和端口
   python src/main.py --host localhost --port 10095
   
   # 指定音频源类型
   python src/main.py --audio_source system_audio
   
   # 指定翻译API地址
   python src/main.py --translate_api http://localhost:8000/translate
   
   # 设置日志级别
   python src/main.py --log_level DEBUG
   ```

### 界面操作

#### 主窗口控制

1. **设备选择**
   - 点击"刷新设备"按钮扫描可用音频设备
   - 从下拉菜单选择合适的音频设备
   - 系统会显示设备类型和采样率信息

2. **识别控制**
   - 🟢 **开始识别**: 启动语音识别和翻译
   - 🔴 **停止识别**: 停止所有处理
   - 🧹 **清空字幕**: 清除所有显示内容
   - 💾 **导出字幕**: 保存字幕到文件

3. **字幕窗口**
   - 🖼️ **显示/隐藏透明字幕**: 切换悬浮窗显示

#### 悬浮字幕窗口操作

1. **窗口操作**
   - **拖拽移动**: 按住左键拖拽窗口
   - **右键菜单**: 右键点击显示设置菜单

2. **个性化设置**
   - **透明度调节**: 30% - 100% 可选
   - **字体大小**: 18px - 40px 可调
   - **窗口关闭**: 关闭悬浮字幕窗口

### 高级配置

#### 音频设置

```bash
# 设置目标采样率
python src/main.py --audio_fs 16000

# 设置音频块参数
python src/main.py --chunk_size "3,6,3" --chunk_interval 1
```

#### 翻译设置

```bash
# 设置翻译超时时间
python src/main.py --timeout_seconds 3

# 禁用ITN（数字标准化）
python src/main.py --use_itn 0

# 设置热词
python src/main.py --hotword "关键词1 20,关键词2 30"
```

#### 输出设置

```bash
# 指定输出目录
python src/main.py --output_dir ./output

# 设置识别模式
python src/main.py --mode 2pass
```

## 🔧 设备配置

### Windows 系统

1. **系统音频录制**
   - 确保启用了"立体声混音"设备
   - 在音频设置中启用"侦听此设备"
   - 推荐使用 PyAudioWPatch 库支持

2. **麦克风设置**
   - 检查麦克风权限设置
   - 调整麦克风音量和增益
   - 确保麦克风不被其他程序占用

### macOS 系统

1. **系统音频录制**
   - 可能需要安装虚拟音频驱动（如 BlackHole）
   - 在系统偏好设置中配置音频路由

2. **权限设置**
   - 允许应用访问麦克风
   - 确保在"安全性与隐私"中启用麦克风权限

### Linux 系统

1. **音频系统**
   - 确保安装了 ALSA 或 PulseAudio
   - 配置音频设备权限
   - 可能需要安装额外的音频驱动

## 📊 性能优化

### 系统要求优化

1. **内存使用**
   - 建议关闭不必要的后台程序
   - 监控内存使用情况
   - 定期清理缓存

2. **CPU性能**
   - 实时语音识别对CPU要求较高
   - 建议在性能模式下运行
   - 避免同时运行其他高CPU占用程序

3. **网络连接**
   - 确保翻译API服务器连接稳定
   - 低延迟网络有助于提升翻译速度

### 配置调优

1. **音频质量 vs 性能**
   ```bash
   # 高质量模式（更高CPU占用）
   python src/main.py --audio_fs 48000 --chunk_size "5,10,5"
   
   # 性能优先模式（降低质量）
   python src/main.py --audio_fs 16000 --chunk_size "3,6,3"
   ```

2. **翻译响应速度**
   ```bash
   # 快速响应（可能影响质量）
   python src/main.py --timeout_seconds 1
   
   # 高质量翻译（稍慢响应）
   python src/main.py --timeout_seconds 3
   ```

## 🐛 故障排除

### 常见问题

#### 1. 音频设备问题

**问题**: 找不到音频设备
**解决方案**:
- 检查设备驱动程序
- 重启音频服务
- 以管理员权限运行程序
- 检查设备是否被其他程序占用

**问题**: 音频质量差
**解决方案**:
- 调整采样率设置
- 检查音频设备设置
- 减少环境噪音
- 调整麦克风位置

#### 2. 翻译问题

**问题**: 翻译服务连接失败
**解决方案**:
- 检查翻译API服务器状态
- 验证网络连接
- 检查防火墙设置
- 确认API地址和端口正确

**问题**: 翻译速度慢
**解决方案**:
- 检查网络延迟
- 调整超时时间设置
- 考虑本地化翻译服务
- 启用翻译缓存

#### 3. 显示问题

**问题**: 字幕窗口不显示
**解决方案**:
- 检查窗口是否被最小化
- 重启应用程序
- 检查显示器配置
- 确认窗口没有移出屏幕范围

**问题**: 字体显示异常
**解决方案**:
- 检查系统字体安装
- 调整字体大小设置
- 重新安装字体包
- 检查系统语言设置

### 日志调试

1. **启用详细日志**
   ```bash
   python src/main.py --log_level DEBUG
   ```

2. **检查日志文件**
   ```bash
   tail -f client.log  # 实时查看日志
   ```

3. **常见错误代码**
   - `ConnectionError`: 网络连接问题
   - `AudioDeviceError`: 音频设备问题
   - `TranslationTimeout`: 翻译服务超时
   - `ConfigError`: 配置参数错误

## 📞 获取帮助

### 命令行帮助

```bash
python src/main.py --help
```

### 社区支持

- 📋 **问题反馈**: 在项目 Issues 页面提交问题
- 💬 **讨论交流**: 参与项目 Discussions
- 📖 **文档**: 查看项目 Wiki 页面
- 🔧 **贡献代码**: 提交 Pull Request

### 技术支持

如果遇到技术问题，请提供以下信息：
1. 操作系统版本
2. Python版本
3. 错误日志内容
4. 重现步骤
5. 系统配置信息

---

**祝您使用愉快！** 🎉